#!/bin/bash
# Wrapper script for the AWS CLI utility to keep the environmentals secret.
# Configuration generated by the unifi_video Puppet module

<% if @aws_access_key_id -%>
# Configure IAM credentials.
export AWS_ACCESS_KEY_ID=<%= @aws_access_key_id %>
export AWS_SECRET_ACCESS_KEY=<%= @aws_secret_access_key %>
<% else %>
# No credentials supplied, assuming IAM role or system-wide config available.
<% end %>

# Correct path to find 'aws' utility
export PATH=/bin:/usr/bin:/usr/local/bin

# Pass command as-is to aws cli S3 and log to syslog
aws s3 $@ 2>&1 | logger -t lsyncd

